# TempData

`TempData` is a JavaScript utility class that allows you to store data temporarily in the browser using indexed databases. This approach is very convenient, for example, if you want to create temporary data to submit to the server later, or if you plan to send multiple data to the server at once. In this case, you can save new data one by one and then submit them together. This way, the data can be retained even after closing your application.

![GitHub stars](https://img.shields.io/github/stars/Nelsallg/easylibs?style=social)
![GitHub issues](https://img.shields.io/github/issues/Nelsallg/easylibs)
![npm version](https://img.shields.io/npm/v/@easylibs/tempdata.svg?style=flat)
![License](https://img.shields.io/badge/license-MIT-blue.svg)
![jsDelivr downloads](https://img.shields.io/jsdelivr/npm/hm/@easylibs/tempdata)

## Installation

To use the `TempData` class, you can install it from npm:

```bash
npm install @easylibs/tempdata
# Or
yarn add @easylibs/tempdata
# Or
pnpm add @easylibs/tempdata
```

Or use direct inclusion with CDN:

```html
<!--MINIFIED-->
<script src="https://cdn.jsdelivr.net/npm/@easylibs/tempdata@latest/dist/tempdata.min.js"></script>
<script src="https://unpkg.com/@easylibs/tempdata@latest/dist/tempdata.min.js"></script>
<!-- OR UNMINIFIED-->
<script src="https://cdn.jsdelivr.net/npm/@easylibs/tempdata@latest/dist/tempdata.js"></script>
<script src="https://unpkg.com/@easylibs/tempdata@latest/dist/tempdata.js"></script>
```

## Getting Started

To use the `TempData` class, you first need to create an instance of the class. You can do this by providing the name of the database, the name of the object store, and the version of the database.

```javascript
new TempData('my-database', 'products_os');
new TempData('my-database', 'customers_os');
new TempData('my-database', 'carts_os');
```

## Adding Data

This code creates a new `TempData` database called `my-database` with object stores called `products_os, customers_os, carts_os` respectively. It then adds the data objects to the object stores. The `add` method returns a promise that resolves to an object indicating the success of the operation.

```javascript
const tempdata = new TempData("my-database");
const products = [
  {
    name: 'Natural wood chair from Gabon',
    price: 150 600,
    description: 30,
    category:"",
    seller: 'Evangzat',
  },
  {
    name: 'Natural wood chair from Gabon',
    price: 3 200,
    color:""
    description: 30,
    category:"Smart phone"
    seller: 'Elise Service',
  }
];
const customer = {
  firstname: 'Guy Bertrant',
  lastname: 'MABIALA MABIALA',
  age: 25,
  job: 'taxi driver',
  country:'RDC'
};
const cart = {
  totalItems: 5,
  totalAmount: 45 775,
  totalFavoriteItems: 1,
  status: "pendding",
};
tempdata.add(customer,"customers_os");
tempdata.add(cart,"carts_os");
tempdata.add(products,"products_os");
```

The `add` method returns a promise that resolves to an object indicating the success of the operation. The object has the following properties:

* `success`: A boolean value indicating whether the operation was successful.
* `elementObject`: The object that was added to the database.

This code creates a new TempData database called `my-database` with an object store called `my-object-store`. It then adds the data object to the object store. The `add` method returns a promise that resolves to an object indicating the success of the operation.

If you do not specify the object store in the `add` method, `TempData` will consider that it is the one specified by default when creating the instance, assuming that you had defined it. Otherwise an error will be thrown.

## Reading Data

### simple reading

```javascript
tempdata.read().then((data)=>{
    console.log(data)
}) //read all elements
tempdata.readOne(1).then((data)=>{
    console.log(data)
}) //read element at index 1
```

### reading by criteria

```javascript
// let's add a new customers to the customers object store
const customer = [
  {
    firstname: 'Sarah Elise',
    lastname: 'OBONE MVOU',
    age: 30,
    job: 'journalist',
    C:'Gabon' 
  },
  {
    firstname: 'Merline',
    lastname: 'SABA GAMBA',
    age: 17,
    country:'Gabon' 
  }
];
tempdata.readBy({job},"customers_os").then((data)=>{
    console.log(data)
}) // returns all customers that have the key "job"
tempdata.readBy({country:"Gabon"},"record","customers_os").then((data)=>{
    console.log(data) // returns all customers that have the country="Gabon"
})
tempdata.readOneBy({'@id':1},"record","products_os").then((data)=>{
    console.log(data)
}) // returns element with '@id'=1. this "@id" key is automatically generated by `TempData` to be able to retrieve each element more easily.
```

## Deleting Data

To delete data from the database, you can use the `deleteAll`, `deleteOne`or `deleteOS` methods

```typescript
const tempdata = new TempData("my-database","customers_os");
tempdata.deleteAll() // delete One element from "customers_os' without remove object store
tempdata.deleteOne(1,null,"carts_os") // delete one element at index 1 from "carts_os'
tempdata.deleteOS('products_os') // delete object store "products_os'
```

## Refactoring Indexes

The `refactorIndexes` method can be used to refactor the indexes of the indexed data.

## Methods

The `TempData` class provides the following methods:

* `add(data)`: Adds one or more items to IDBObjectStore with the provided object. The data can be an object or an array of objects.
* `readOne(i,type)`: Retrieve the element at the specified index.
* `readOneBy(criteria,type)`: Retrieve the element at the specified index according to the criteria.
* `read()`: Recovers all elements.
* `readBy(criteria)`: Recovers all elements that respect the critaria.
* `update(id,data)`: Updates an item.
* `deleteOne(id,refactoringShortKeyString,callback)`: Deletes the object with the specified ID from the IDBObjectStore.
* `deleteOS`: Delete the `ObjectStore`
* `deleteAll()`: Removes every record stored in the database.
* `_isEmpty()`: Checks if databse is empty.
* `_length()`: Retrieves the length of the object store.
* `_getObjectStore(access)`: Retrieves the IDBObjectStore with the specified access mode from the opened database.
* `refactorIndexes(refactoringShortKeyString)`: Refactors the indexes of the indexed data based on the provided string.
