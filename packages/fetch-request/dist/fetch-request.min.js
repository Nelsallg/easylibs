!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("fetch-request",[],o):"object"==typeof exports?exports["fetch-request"]=o():t["fetch-request"]=o()}(self,(()=>(()=>{"use strict";var t={};return{505:function(t,o){var i=this&&this.__awaiter||function(t,o,i,e){return new(i||(i=Promise))((function(s,n){function r(t){try{a(e.next(t))}catch(t){n(t)}}function h(t){try{a(e.throw(t))}catch(t){n(t)}}function a(t){var o;t.done?s(t.value):(o=t.value,o instanceof i?o:new i((function(t){t(o)}))).then(r,h)}a((e=e.apply(t,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0});o.default=class{constructor(t){this.preFetch=()=>i(this,void 0,void 0,(function*(){if("function"==typeof this.options.onPreFetch){let t=yield this.options.onPreFetch();t&&(this.options.data=t.data)}})),this.fetchData=()=>i(this,void 0,void 0,(function*(){try{if(!this.options)throw new Error("Missing Options for the request");if(!this.options.uri)throw new Error("L'URI est obligatoire");if(!this.options.options||!this.options.options.method)throw new Error("La méthode d'appel est obligatoire");const t=yield fetch(this.options.uri,{method:this.options.options.method,body:this._formData,headers:{"X-Requested-With":"XMLHttpRequest"}}),o=yield t.json();if(this._response=o,this.options.onPostFetch&&this.options.onPostFetch(o),this.options.onSuccess)return this.options.onSuccess(o)}catch(t){if(this.options.onError)return this.options.onError(t);console.error(t)}})),this.postFetch=()=>i(this,void 0,void 0,(function*(){return this.options.submiter instanceof HTMLButtonElement&&this.options.submiter.removeAttribute("disabled"),this.options.onPostFetch?this.options.onPostFetch():void 0})),this.submitForm=()=>i(this,void 0,void 0,(function*(){try{this.options.onPreFetch&&(yield this.preFetch()),yield this.fetchData(),this.options.onPostFetch&&(yield this.postFetch())}catch(t){console.error("Erreur lors de l'envoi du formulaire : ",t)}})),this.createFormData=t=>{const o=new FormData;for(const[i,e]of Object.entries(t))o.append(i,null!=e?e:"");return o},this.createJSON=t=>JSON.stringify({data:t}),this.options=t,t.submiter?t.submiter.addEventListener("click",this.submitForm):this.submitForm()}get _formData(){const t=t=>t instanceof FormData,o=t=>Array.isArray(t),i=t=>"object"==typeof t&&Object.keys(t).length>0;if(this.options.options){const e=this.options.options.acceptDataFormat;if(e)switch(e){case"form-data":if(t(this.options.data))return this.options.data;if(o(this.options.data))return this.createJSON(this.options.data);if(i(this.options.data))return this.createFormData(this.options.data);break;case"classic-object":if(t(this.options.data)||o(this.options.data)||i(this.options.data))return this.createJSON((o(this.options.data),this.options.data));break;default:throw Error(`Le format ${e} n'est pas supporté`)}}}get response(){return this._response}}}}[505](0,t),t})()));
//# sourceMappingURL=fetch-request.min.js.map