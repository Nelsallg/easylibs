!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("fetch-request",[],e):"object"==typeof exports?exports["fetch-request"]=e():t["fetch-request"]=e()}(self,(()=>(()=>{"use strict";var t={};return{505:function(t,e){var o=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,s){function r(t){try{a(i.next(t))}catch(t){s(t)}}function c(t){try{a(i.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,c)}a((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.options=t,this.attachSubmitterEvent()}attachSubmitterEvent(){this.options.submitter?this.options.submitter.addEventListener("click",this.submitForm):this.submitForm()}submitForm(){return o(this,void 0,void 0,(function*(){try{this.options.callbacks.onPreFetch&&(yield this.preFetch()),yield this.run(),this.options.callbacks.onPostFetch&&(yield this.postFetch())}catch(t){this.handleError(t,void 0,"Error executing query : ")}}))}run(){var t;return o(this,void 0,void 0,(function*(){let e=null;try{const{uri:o,data:i,options:n}=this.options;if(!o)throw new Error("URI is required");let s=o,r=null;n&&"GET"===n.method&&i?s=this.buildGetRequestUrl(o,i):i&&(r=this.prepareRequestBody(i));const c={method:(null==n?void 0:n.method)||"GET",headers:null==n?void 0:n.headers,body:r,credentials:null==n?void 0:n.credentials,mode:null==n?void 0:n.mode,cache:null==n?void 0:n.cache,integrity:null==n?void 0:n.integrity};e=yield fetch(s,c),this.response=this.options.options.responseType&&"text"===this.options.options.responseType?yield e.text():yield e.json(),(null===(t=this.options.callbacks)||void 0===t?void 0:t.onSuccess)&&e.ok&&this.options.callbacks.onSuccess(this.response)}catch(t){this.handleError(t,e?e.status:0)}}))}preFetch(){return o(this,void 0,void 0,(function*(){if("function"==typeof this.options.callbacks.onPreFetch){let t=yield this.options.callbacks.onPreFetch(this.options.data);t&&(this.options.data=t.data)}}))}postFetch(){return o(this,void 0,void 0,(function*(){return this.options.submitter instanceof HTMLButtonElement&&this.options.submitter.removeAttribute("disabled"),this.options.callbacks.onPostFetch?this.options.callbacks.onPostFetch():void 0}))}buildGetRequestUrl(t,e){const o=new URL(t,window.location.origin),i=new URLSearchParams;if(e instanceof FormData)for(let[t,o]of e.entries())"string"==typeof o&&i.append(t,o);else for(let[t,o]of Object.entries(e))i.append(t,o);return o.search=i.toString(),o.toString()}prepareRequestBody(t){var e,o;return"form-data"!==(null===(e=this.options.options)||void 0===e?void 0:e.acceptDataFormat)||t instanceof FormData?"classic-object"===(null===(o=this.options.options)||void 0===o?void 0:o.acceptDataFormat)?JSON.stringify(t):t:this.convertObjectToFormData(t)}convertObjectToFormData(t){const e=new FormData;return Object.entries(t).forEach((([t,o])=>e.append(t,o))),e}handleError(t,e,o="Fetch Request Error: "){var i;console.error(o,t),(null===(i=this.options.callbacks)||void 0===i?void 0:i.onError)&&this.options.callbacks.onError(t,e||0)}}}}[505](0,t),t})()));
//# sourceMappingURL=fetch-request.min.js.map