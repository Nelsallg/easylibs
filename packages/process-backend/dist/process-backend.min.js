/*! For license information please see process-backend.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("process-backend",[],e):"object"==typeof exports?exports["process-backend"]=e():t["process-backend"]=e()}(self,(()=>{return t={287:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,s){function i(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=o(r(78)),i=r(582),a=o(r(792));e.default=class{constructor(t,e){this._response=null,this._database=t,this._uri=e}persist(t,e=(t=>{})){return n(this,void 0,void 0,(function*(){const r=yield this._database.getIndexedData(),o=[];if(r instanceof Array&&r.length>0)for(let t=0;t<r.length;t++)(t=>{o.push(new Promise(((e,r)=>n(this,void 0,void 0,(function*(){try{const r=yield this._database._getData(t,"classic-object");delete r["@base64String"],delete r["@id"],e(r)}catch(t){r("Désolé une probleme est survenu: "+t)}})))))})(t);const i=this.normalizeArrayField(yield Promise.all(o));new s.default({uri:this._uri,data:i,onPostFetch:r=>(this._response=r,e(this._response),t&&this._response&&this._response.success?window.location.href=t||"/":this._response),options:{method:"POST",acceptDataFormat:"form-data"}})}))}save(t){var e;const r=null!==(e=t.submiter.closest("form"))&&void 0!==e?e:document.querySelector("form");t.submiter.addEventListener("click",(e=>n(this,void 0,void 0,(function*(){e.preventDefault();const n=yield this._database._isEmpty();if(!0===n&&!r.checkValidity())return r.reportValidity();const o=a.default.escape(t.submiter.innerHTML);if(t.loader&&(t.submiter.innerHTML=t.loader),!0===n&&r.checkValidity()){const e=new FormData(r);t.preFetchAction&&t.preFetchAction(e);const n=function(){const{response:e}=i;return t.submiter.innerHTML=o,t.redirectUrl&&!0===e.success?(t.callback(e),window.location.href=t.redirectUrl):t.callback(e)},i=new s.default({uri:this._uri,data:e,onPostFetch:n,options:{method:"POST",acceptDataFormat:"form-data"}})}else r.setAttribute("novalidate",""),yield this.persist(t.redirectUrl,(e=>{t.submiter.innerHTML=o,t.callback(e)}))}))))}normalizeArrayField(t){const e=new i.Transformer.BlobTransformer;return t.reduce(((t,r)=>(Object.keys(r).reduce(((t,n)=>{const o=r[n];return Array.isArray(o)&&o.length>0?o.forEach((r=>{t.append(n,e.fromFile(r),r.name)})):t.set(n,r[n]),t}),new FormData).forEach(((e,r)=>{t.append(r,e)})),t)),new FormData)}get response(){return this._response}}},78:t=>{var e;self,e=()=>(()=>{"use strict";var t={};return{"./src/fetch-request.ts":function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,s){function i(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.fetchData=()=>r(this,void 0,void 0,(function*(){try{if(!this.options)throw new Error("Missing Options for the request");if(!this.options.uri)throw new Error("URI is required");if(!this.options.options||!this.options.options.method)throw new Error("The calling method is required");const t=yield fetch(this.options.uri,{method:this.options.options.method,body:this._formData,headers:{"X-Requested-With":"XMLHttpRequest"}}),e=yield t.json();if(this._response=e,this.options.onPostFetch&&this.options.onPostFetch(e),this.options.onSuccess&&200===t.status)return this.options.onSuccess(e)}catch(t){if(this.options.onError&&200!==this._response.status)return this.options.onError(t,this._response.status);console.error(t)}})),this.preFetch=()=>r(this,void 0,void 0,(function*(){if("function"==typeof this.options.onPreFetch){let t=yield this.options.onPreFetch(this.options.data);t&&(this.options.data=t.data)}})),this.postFetch=()=>r(this,void 0,void 0,(function*(){return this.options.submiter instanceof HTMLButtonElement&&this.options.submiter.removeAttribute("disabled"),this.options.onPostFetch?this.options.onPostFetch():void 0})),this.submitForm=()=>r(this,void 0,void 0,(function*(){try{this.options.onPreFetch&&(yield this.preFetch()),yield this.fetchData(),this.options.onPostFetch&&(yield this.postFetch())}catch(t){console.error("Error executing query : ",t)}})),this.createFormData=t=>{const e=new FormData;for(const[r,n]of Object.entries(t))e.append(r,null!=n?n:"");return e},this.createJSON=t=>JSON.stringify({data:t}),this.options=t,t.submiter?t.submiter.addEventListener("click",this.submitForm):this.submitForm()}get _formData(){const t=t=>t instanceof FormData,e=t=>Array.isArray(t),r=t=>"object"==typeof t&&Object.keys(t).length>0;if(this.options.options){const n=this.options.options.acceptDataFormat;if(n)switch(n){case"form-data":if(t(this.options.data))return this.options.data;if(e(this.options.data))return this.createJSON(this.options.data);if(r(this.options.data))return this.createFormData(this.options.data);break;case"classic-object":if(t(this.options.data)||e(this.options.data)||r(this.options.data))return this.createJSON((e(this.options.data),this.options.data));break;default:throw Error(`The ${n} format is not supported`)}}}get response(){return this._response}}}}["./src/fetch-request.ts"](0,t),t})(),t.exports=e()},582:t=>{var e;self,e=()=>(()=>{"use strict";var t={};return{"./src/transformer.ts":function(t,e){var r,n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,s){function i(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,a)}c((n=n.apply(t,e||[])).next())}))};function o(t,e="both"){const r=t.split(",")[0].split(":")[1].split(";")[0].split("/")[1],n=t.split(",")[0].split(":")[1].split(";")[0].split("/")[0];return"type"===e?n:"extension"===e?r:n+"/"+r}Object.defineProperty(e,"__esModule",{value:!0}),e.Transformer=void 0,function(t){t.Base64Transformer=class{constructor(){this.base64String=""}toFile(t,e){this.base64String=t;const r=window.atob(t.split(",")[1]),n=[];let s="";for(let t=0;t<r.length;t+=512){const e=r.slice(t,t+512),o=new Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);const s=new Uint8Array(o);n.push(s)}const i=o(t,"extension"),a=o(t,"type");return s=e||`tranformed_file.${i}`,new File(n,s,{type:`${a}/${i}`})}fromFile(t){return new Promise(((e,r)=>{const n=new FileReader;n.onloadend=()=>{e(n.result)},n.onerror=t=>{r(t)},n.readAsDataURL(t)}))}toUint8Array(t){const e=window.atob(t.split(",")[1]),{length:r}=e,n=new Uint8Array(r);for(let t=0;t<r;t++)n[t]=e.charCodeAt(t);return n}fromUint8Array(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return window.btoa(e)}fromBlob(t){return n(this,void 0,void 0,(function*(){return new Promise((e=>{const r=new FileReader;r.onloadend=function(){const{result:t}=r;e(t||"")},r.readAsDataURL(t)}))}))}},t.BlobTransformer=class{fromUint8Array(t,e){return e=null!=e?e:"",new Blob([t],{type:e})}fromFile(t){return t.slice(0,t.size,t.type)}fromBase64String(t,e){e=e||"";const r=window.atob(t.split(",")[1]),n=new Array(r.length);for(let t=0;t<r.length;t++)n[t]=r.charCodeAt(t);const o=new Uint8Array(n);return new Blob([o],{type:e})}},t.FileTransformer=class{toBase64(t){return new Promise(((e,r)=>{const n=new FileReader;n.onloadend=()=>{e(n.result)},n.onerror=t=>{r(t)},n.readAsDataURL(t)}))}fromBase64String(t,e,r,n=!0){e=e||"";const o=n?t.split(",")[1]:t,s=window.atob(o),i=new Array(s.length);for(let t=0;t<s.length;t++)i[t]=s.charCodeAt(t);const a=new Uint8Array(i),c=new Blob([a],{type:e});return r=r||"image",new File([c],r,{type:e})}fromUint8Array(t,e,r){return new File(t,r,{type:e})}},t.FormDataTransformer=class{constructor(t){this._data=t}transform(){const t=new FormData;if("object"==typeof this._data){let e=this._data;try{for(const r in this._data)this._data.hasOwnProperty(r)&&t.append(r,e[r])}catch(t){console.error("Erreur détectée: "+t)}}return t}reverse(){let t={};if(this._data instanceof FormData)try{const e={};this._data.forEach(((t,r)=>{e[r]=t})),t=Object.assign({},e)}catch(t){console.error("Erreur détectée: "+t)}return t}option(t){return"onlyobject"===t?this._data instanceof FormData?this.reverse():this._data:"onlyformdata"===t?this._data instanceof FormData?this._data:this.transform():"auto"===t?this.auto():void 0}auto(){return this._data instanceof FormData?this.reverse():this.transform()}}}(r||(e.Transformer=r={}))}}["./src/transformer.ts"](0,t),t})(),t.exports=e()},792:t=>{var e;self,e=()=>(()=>{"use strict";var t={};return(()=>{var e=t;Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static setAudio(t,e=null){const r=document.createElement("audio");null!=e&&r.classList.add(e);const n=document.createElement("source");return n.src=this.resolvePath(t),n.type="audio/mpeg",r.appendChild(n),r}static textToHTMLElement(t,e="div",r=!1){const n=document.createElement(`${e}`);return n.innerHTML=t,!0===r?n.children:n.firstElementChild}static $$(t){if(t instanceof HTMLElement||t instanceof HTMLCollection)return t;if("string"!=typeof t)throw new Error("Type of element is not supported");{const e=document.querySelectorAll(`${t}`),r=document.querySelector(`${t}`);if(null!==e&&e.length>1)return e;if(null!==r)return r}}static processNodes(t,e=((t,e)=>{})){return t instanceof NodeList||Array.isArray(t)?Array.from(t).forEach(((t,r)=>{e(t,r)})):null!=t?e(t):void 0}static getRegexp(t){switch(t){case"email":return new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/i);case"phone-number":return new RegExp(/^(0|\\+[1-9]{1,3})[0-9 ]+$/);case"number":return new RegExp(/^[0-9]+$/);case"strong-password":return new RegExp(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/);case"url":return new RegExp(/^(ht|f)tp(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\'\/\\\+&amp;%\$#_]*)?$/);case"default-text":return new RegExp(/^[a-zA-Z -'áàâäãåçéèêëğíìîïıñóòôöõúùûüşýÿæœÁÀÂÄÃÅÇÉÈÊËĞÍÌÎÏIÑÓÒÔÖÕÚÙÛÜŞÝŸÆŒ]+$/);case"fr-text":return new RegExp(/^[A-Za-z' - àâçéèêëûæœÀÂÉÈÊËÆŒ]+$/);case"en-text":return new RegExp(/^[a-zA-Z '-]{1,40}$/);case"tr-text":return new RegExp(/^[A-Za-z çğıöüşæœÇĞIÖÜŞ]+$/);default:throw new Error("Type d'expression régulière non pris en charge.")}}static resolvePath(t){const e=window.location.pathname.split("/")[1],r=window.location.origin,n=(window.location.port,window.location.host);return"localhost"==n?r+`/${e}/${t}`:r+`/${t}`}static forbiddener(t="td",e){let r=document.createElement(t);r.setAttribute("class","forbidden");const n={position:"absolute",width:"100%",height:"100%",opacity:".7",zIndex:"10",backgroundColor:e||"#FFFFFF"};return Object.assign(r.style,n),r}static reduceText(t,e=14){return(t="string"==typeof t?t.trim():"").length>e?`${t.substring(0,e)}...`:t}static changeInputTextTypeToNumberType(t,e,r=!1,n){this.processNodes(this.$$(t),(function(t){let o=t;o&&o.addEventListener("input",(function(){const t=r?/^[0-9]+([.,][0-9]+)?$/:/[^\d]/g;if(n){const e=o.value.replace(t,"");o.value=`${parseFloat(e).toFixed(n)}`}else o.value=o.value.replace(t,"");e&&parseInt(o.value)>e&&(o.value=`${e}`)}))}))}static disablor(t="td",e,r,n){const o=document.querySelectorAll("[disablor],[self-disablor]");try{if(!r&&!o)throw new Error("Aucun bouton avec l'attribut <disablor> n'est détecté, vous pouvez le passer manuellement");this.processNodes(o,(r=>{r.addEventListener("click",(()=>{let o=r.hasAttribute("self-disablor")?r:r.closest("[disablor]");if(!e&&!o)throw new Error("Aucun élément à désactiver contenant l'attribut <disablor> n'est détecté, vous pouvez le passer manuellement");o&&(o.style.position="relative",o.insertBefore(this.forbiddener(t,n),o.firstChild),o instanceof HTMLButtonElement&&o.setAttribute("disabled","true"))}))}))}catch(t){console.error("Une erreur s'est produit: ",t)}}static setAsteriskToRequiredField(){const t=document.querySelectorAll("label[required-field]");t&&this.processNodes(t,(t=>{const e=document.createRange().createContextualFragment('<svg class="required-svg">\n        <use xlink:href="../asset/icon.svg#asterisk"></use>\n        </svg>');t.appendChild(e)}))}static hasKeyWithNameSubstring(t,e,r){for(let n in t)if(n.includes(e)){if(void 0===r||!1===r)return t[n];if(!0===r)return n}return!1}static findObjectDataByKeyName(t,e,r){return Object.keys(t).forEach((r=>{if(r.includes(e))return t[r]})),!1}static findChar(t,e,r=!1){for(let n=0;n<=e;n++)if(-1!==t.indexOf(n.toString()))return!!r||n.toString();return!r&&null}static findComputedStyle(t,e){const r=window.getComputedStyle(t),n={};try{if(!t)throw new Error("Element not found");if(!e)throw new Error("Property is required");if(Array.isArray(e)&&e.length>0)return e.forEach((t=>{n[`${t}`]=r.getPropertyValue(`${t}`)})),n;if("string"==typeof e)return r.getPropertyValue(`${e}`)}catch(t){console.error(t)}}static escape(t){if(!t)return"";const e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}static findHTMLElementBy(t,e){let r=t;if(r)for(;r=r.previousElementSibling;){const t=r.querySelector(e);if(t)return t}return null}static formatHTMLAttributes(t){let e="";if(t)for(const[r,n]of Object.entries(t))r&&(e+=`${r}='${n}'`);return e.trim()}}})(),t})(),t.exports=e()}},e={},function r(n){var o=e[n];if(void 0!==o)return o.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,r),s.exports}(287);var t,e}));
//# sourceMappingURL=process-backend.min.js.map